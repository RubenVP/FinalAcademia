CREATE  TABLE IF NOT EXISTS USERS (
  USERS_ID INTEGER IDENTITY PRIMARY KEY, 
  USERNAME VARCHAR(45) NOT NULL,
  password VARCHAR(45) NOT NULL,
  name VARCHAR(50) NOT NULL,
  last_name VARCHAR(50),
  email VARCHAR(255) NOT NULL,
  enabled BOOLEAN NOT NULL
);

CREATE TABLE IF NOT EXISTS USER_ROLES (
  USER_ROLES_ID INTEGER IDENTITY PRIMARY KEY, 
  USERNAME varchar(45) NOT NULL,
  role varchar(45) NOT NULL
);

CREATE TABLE IF NOT EXISTS QUESTION (
	QUESTION_ID INTEGER IDENTITY PRIMARY KEY, 
	CATEGORY_ID VARCHAR(20) NOT NULL,
	TITLE VARCHAR(100) NOT NULL,
	DESCRIPTION VARCHAR(255) NOT NULL,
	ANSWERED BOOLEAN NOT NULL,
	USERS_ID INTEGER NOT NULL,
	CREATE_DATE TIMESTAMP NOT NULL,
	FOREIGN KEY (USERS_ID) REFERENCES USERS(USERS_ID)
);

CREATE TABLE IF NOT EXISTS COMMENT (
	COMMENT_ID INTEGER IDENTITY PRIMARY KEY,
	QUESTION_ID INTEGER NOT NULL,
	USERS_ID INTEGER NOT NULL,
	DESCRIPTION VARCHAR(255) NOT NULL,
	ANSWER_DATE TIMESTAMP NOT NULL,
	FOREIGN KEY (QUESTION_ID) REFERENCES QUESTION(QUESTION_ID),
	FOREIGN KEY (USERS_ID) REFERENCES USERS(USERS_ID)
);

CREATE TABLE IF NOT EXISTS MESSAGE (
	MESSAGE_ID INTEGER IDENTITY PRIMARY KEY,
	DESCRIPTION VARCHAR(255) NOT NULL,
	QUESTION_ID INTEGER NOT NULL,
	SENDER_USER_ID INTEGER NOT NULL,
	RECIPIENT_USER_ID INTEGER NOT NULL,
	MESSAGE_DATE TIMESTAMP NOT NULL,
	IS_NEW BOOLEAN NOT NULL, 
	FOREIGN KEY (QUESTION_ID) REFERENCES QUESTION(QUESTION_ID),
	FOREIGN KEY (SENDER_USER_ID) REFERENCES USERS(USERS_ID),
	FOREIGN KEY (RECIPIENT_USER_ID) REFERENCES USERS(USERS_ID)
);

INSERT INTO users(username, password, enabled, name, email)
VALUES ('admin','admin123', true, 'Administrator', 'ruben.valderrabano@softtek.com');
INSERT INTO users(username, password, enabled, name, last_name, email)
VALUES ('user','user123', true, 'Ruben', 'Valderrabano', 'ruben.valderrabano@softtek.com');

INSERT INTO user_roles (username, role)
VALUES ('admin', 'ROLE_ADMIN');
INSERT INTO user_roles (username, role)
VALUES ('user', 'ROLE_USER');

INSERT INTO QUESTION (CATEGORY_ID, TITLE, DESCRIPTION, ANSWERED, USERS_ID, CREATE_DATE)
VALUES ('product', 'Question 1', 'I relly do not have isea ehat to put in here', false, 1, NOW());

INSERT INTO QUESTION (CATEGORY_ID, TITLE, DESCRIPTION, ANSWERED, USERS_ID, CREATE_DATE)
VALUES ('app', 'Question 2', 'I relly do not have isea ehat to put in here again', false, 1, NOW());

INSERT INTO QUESTION (CATEGORY_ID, TITLE, DESCRIPTION, ANSWERED, USERS_ID, CREATE_DATE)
VALUES ('product', 'Question 2', 'Once again I do not have isea ehat to put in here', false, 1, NOW());
